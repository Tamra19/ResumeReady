{% extends 'base.html' %}

{% block title %}Dashboard - Resume Builder{% endblock %}

{% block content %}
<h2>Build Your Resume</h2>
<hr>
<form method="post">
    {% csrf_token %}

    <div class="card mb-4">
        <div class="card-header">Personal Information</div>
        <div class="card-body">
            <div class="mb-3"><label class="form-label">Full Name</label><input type="text" name="name" class="form-control" value="{{ profile.name }}"></div>
            <div class="mb-3"><label class="form-label">Email</label><input type="email" name="email" class="form-control" value="{{ profile.email }}"></div>
            <div class="mb-3"><label class="form-label">Phone</label><input type="text" name="phone" class="form-control" value="{{ profile.phone }}"></div>
            <div class="mb-3"><label class="form-label">Address</label><input type="text" name="address" class="form-control" value="{{ profile.address }}"></div>
            <div class="mb-3"><label class="form-label">Summary</label><textarea name="summary" class="form-control">{{ profile.summary }}</textarea></div>
            <div class="mb-3"><label class="form-label">Skills (comma-separated)</label><input type="text" name="skills" class="form-control" value="{{ profile.skills }}"></div>
        </div>
    </div>

    <div class="card mb-4">
        <div class="card-header d-flex justify-content-between">
            <span>Work Experience</span>
            <button type="button" class="btn btn-sm btn-success" id="add-experience">Add Experience</button>
        </div>
        <div class="card-body" id="experience-container">
            {% for exp in profile.experience_set.all %}
            <div class="experience-form mb-3 border p-3">
                <input type="text" name="company" placeholder="Company" class="form-control mb-2" value="{{ exp.company }}">
                <input type="text" name="position" placeholder="Position" class="form-control mb-2" value="{{ exp.position }}">
                <input type="date" name="start_date_exp" class="form-control mb-2" value="{{ exp.start_date|date:'Y-m-d' }}">
                <input type="date" name="end_date_exp" class="form-control mb-2" value="{{ exp.end_date|date:'Y-m-d' }}">
                <textarea name="description" placeholder="Description" class="form-control">{{ exp.description }}</textarea>
            </div>
            {% endfor %}
        </div>
    </div>

    <div class="card mb-4">
        <div class="card-header d-flex justify-content-between">
            <span>Education</span>
            <button type="button" class="btn btn-sm btn-success" id="add-education">Add Education</button>
        </div>
        <div class="card-body" id="education-container">
            {% for edu in profile.education_set.all %}
            <div class="education-form mb-3 border p-3">
                <input type="text" name="institution" placeholder="Institution" class="form-control mb-2" value="{{ edu.institution }}">
                <input type="text" name="degree" placeholder="Degree" class="form-control mb-2" value="{{ edu.degree }}">
                <input type="text" name="field_of_study" placeholder="Field of Study" class="form-control mb-2" value="{{ edu.field_of_study }}">
                <input type="date" name="graduation_date" class="form-control" value="{{ edu.graduation_date|date:'Y-m-d' }}">
            </div>
            {% endfor %}
        </div>
    </div>

    <button type="submit" class="btn btn-primary">Save & Preview</button>
</form>
{% endblock %}

{% block extra_js %}
<script>
    document.getElementById('add-experience').addEventListener('click', function() {
        let container = document.getElementById('experience-container');
        let form = document.createElement('div');
        form.className = 'experience-form mb-3 border p-3';
        form.innerHTML = `
            <input type="text" name="company" placeholder="Company" class="form-control mb-2">
            <input type="text" name="position" placeholder="Position" class="form-control mb-2">
            <input type="date" name="start_date_exp" class="form-control mb-2">
            <input type="date" name="end_date_exp" class="form-control mb-2">
            <textarea name="description" placeholder="Description" class="form-control"></textarea>
        `;
        container.appendChild(form);
    });

    document.getElementById('add-education').addEventListener('click', function() {
        let container = document.getElementById('education-container');
        let form = document.createElement('div');
        form.className = 'education-form mb-3 border p-3';
        form.innerHTML = `
            <input type="text" name="institution" placeholder="Institution" class="form-control mb-2">
            <input type="text" name="degree" placeholder="Degree" class="form-control mb-2">
            <input type="text" name="field_of_study" placeholder="Field of Study" class="form-control mb-2">
            <input type="date" name="graduation_date" class="form-control">
        `;
        container.appendChild(form);
    });
</script>
{% endblock %}